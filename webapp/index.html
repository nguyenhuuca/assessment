<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
</head>
<body>

<div class="container">
  <div class="row">
    <div class="col-5">
      <h1>Funny Movies</h1>
    </div>
    <div class="col-7" style="margin-top: 10px;">
      <form>
       <div class="row">
          <div id ="wcJoin" class="form-gr oup col-6">Welcome nguyenhuuca@gmailcom</div>
          <div id = "grUser" class="form-gr oup col-3">
            <input type="text"  placeholder="User name"  class="form-control" id="usr">
          </div>
          <div id = "grPass" class="form-group col-3">
            <input type="password" placeholder="Password" class="form-control" id="pwd">
          </div>
          <div class="form-group col-6">
            <button id = "shareBtn" type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#shareModal">Share a movie</button>
            <button id = "loginBtn" onclick="joinSystem()" type="button" class="btn btn-light">Register / Login</button>
            <button id = "logoutBtn" onclick="logout()" type="button" class="btn btn-light">Logout</button>
         
          </div>
       </div>
      </form>
    </div>
  </div>
  <hr></hr>
  <div id = "list-video">  
  </div>
  <div class="modal fade" id="shareModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="shareModalLabel">Share a Youtube movie</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form>
            <div class="mb-3">
              <label for="message-text" class="col-form-label">Youtube URL:</label>
              <input class="form-control" id="message-text"></input>
            </div>
            <div class="mb-3">
              <button style="width: 100%;"type="button" class="btn btn-primary" onclick="share()">Share</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
  <script>
    function VideoObj(id, userShared, title, src, desc) {
          this.id = id;
          this.userShared = userShared;
          this.title = title;
          this.src = src;
          this.desc = desc;
    };

    function share() {
      console.log("update db");

    };

    function joinSystem() {
      console.log("join system");

      $("#shareBtn").show();
      $("#logoutBtn").show();
      $("#wcJoin").show();

      $("#loginBtn").hide()
      $("#grUser").hide()
      $("#grPass").hide()

    };

    function logout() {
      console.log("logout system");
      init();
      $("#loginBtn").show()

    };

    function voteUp(element) {
      var id = $(element).attr("id");
      var idItem = "#"+ id.split("_")[0] + "_" + "upCount";
      var val= $(idItem).text();
      val = parseInt(val) + 1;
      $(idItem).text(val);
    };

    function voteDown(element) {
      var id = $(element).attr("id");
      var idItem = "#"+ id.split("_")[0] + "_" + "downCount";
      var val = $(idItem).text();
      val = parseInt(val) - 1;
      $(idItem).text(val);
    };


    function init() {
      $("#shareBtn").hide();
      $("#logoutBtn").hide();
      $("#wcJoin").hide();

      $("#grUser").show()
      $("#grPass").show()
    }
      // template list
    function loadTemplate() {
      return ` <div class="row">
      <!-- 16:9 aspect ratio -->
      <div class="col-6">
        <div class="ratio ratio-16x9">
          <iframe src="{{linkYotube}}" allowfullscreen></iframe>
        </div>
      </div>
      <div class="col-6">
        <div style="color:red; font-weight:bold;">{{movi_title}}</div>
        <div>
          <div style = "float:left; width:200px;">Shared by:{{userName}}</div>
          <div>
            <span id = "{{id_upVote}}" onclick = "voteUp(this)"><i class="far fa-thumbs-up fa-2x"></i></span>
            <span id = "{{id_downVote}}" onclick = "voteDown(this)""><i class="far fa-thumbs-down fa-2x"></i></span>  
          </div> 
          
        </div>
        <div>
          <span id = "{{id_upCount}}" style="float: left; margin-right: 10px;">123</span><span><i class="far fa-thumbs-up"></i></span>
          <span id = {{id_downCount}}>100</span> <span><i class="far fa-thumbs-down"></i></span>
        </div>
        <div>Description:</div>
        <p>{{desc}}</p>
      </div>
    </div>
    </br>`;
    }
  </script>

  <script>
    var data = [];
    init();
    const video1 = new VideoObj(1, "nguyenhuuca", "Test share", "https://www.youtube.com/embed/h_GqRV-SZmU", 'This is new video');
    const video2 = new VideoObj(2, "canh", "Test share", "https://www.youtube.com/embed/h_GqRV-SZmU", 'This is new video');
    const video3 = new VideoObj(3, "canh", "Test share", "https://www.youtube.com/embed/h_GqRV-SZmU", 'This is new video');
    data.push(video1);
    data.push(video2);
    data.push(video3);
    data.forEach(item => {
      var stringHtml = loadTemplate();
      stringHtml = stringHtml.replace("{{linkYotube}}", item.src);
      stringHtml = stringHtml.replace("{{movi_title}}", item.title);
      stringHtml = stringHtml.replace("{{userName}}", item.userShared);
      stringHtml = stringHtml.replace("{{desc}}", item.desc);
      stringHtml = stringHtml.replace("{{id_upCount}}", item.id +"_upCount");
      stringHtml = stringHtml.replace("{{id_downCount}}", item.id+"_downCount");
      stringHtml = stringHtml.replace("{{id_upVote}}", item.id+"_upVote");
      stringHtml = stringHtml.replace("{{id_downVote}}", item.id+"_downVote");
      $('#list-video').append(stringHtml);
    });
  </script>
</body>
</html>